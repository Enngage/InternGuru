@model UI.Builders.Internship.Views.InternshipDetailView
@using Core.Helpers;
@using UI.Builders.Gallery.Views;
@using UI.Builders.Gallery.Models;
@using UI.Helpers
@using UI.Modules.GoogleMaps.Views
@{
    Model.Metadata.BasicMetadata.Title = $"{Model.Internship.Title} | Stáž";
    Model.Metadata.BasicMetadata.Description = Model.Internship.Description;
    Model.Metadata.Social.GoogleMetadata.Image = Helpers.ImageHelper.GetCompanyBanner(Model.Internship.Company.CompanyGuid);
    Model.Metadata.Social.OpenGraphMetadata.Image = Helpers.ImageHelper.GetCompanyBanner(Model.Internship.Company.CompanyGuid);
    Layout = "~/Views/Shared/Body/Dark.cshtml";

    // get gallery images
    var galleryImages = Helpers.ImageHelper.GetCompanyGalleryImages(Model.Internship.Company.CompanyGuid).Select(m => new GalleryImage()
    {
        Url = m.Value
    }).ToList();
}

@TODO_HEADER

@Helpers.ScriptHelper.RequireScript("/scripts/views/internship/detail")

<div class="ui container w-margin-top-14">
    <div class="ui grid">
        <div class="sixteen wide column w-padding-bottom-0">
            <a href="@Url.Action("Index", "Company", new { codeName = Model.Internship.Company.CompanyCodeName })">
                <img alt="@Model.Internship.Company.CompanyName banner" src="@Helpers.ImageHelper.GetTransparentImage()" data-src="@Helpers.ImageHelper.GetCompanyBanner(Model.Internship.Company.CompanyGuid)" class="ui image fluid w-internship-detail-banner" />
            </a>
        </div>
    </div>
</div>

<div id="_InternshipMenuWrapper" class="w-internship-fixed-wrapper">
    <div class="ui container">
        <div class="ui vertical segment w-internship-menu-wrapper">
            <img alt="Company logo" class="ui mini image w-internship-icon" src="@Helpers.ImageHelper.GetTransparentImage()" data-src="@Helpers.ImageHelper.GetCompanyLogo(Model.Internship.Company.CompanyGuid)">

            <h1>
                @Model.Internship.Title
            </h1>

            <div class="w-internship-menu-right">
                <a href="@Url.Action("Internship", "Form", new { id = Model.Internship.ID, codeName = Model.Internship.CodeName })">
                    <div class="ui button secondary">
                        Odpovědět
                    </div>
                </a>
            </div>

            <div class="w-body-clear"></div>
        </div>
    </div>
</div>


<div class="ui container w-margin-top-20 w-padding-bottom-30">
    <div class="ui grid">
        <div class="sixteen wide mobile sixteen wide tablet sixteen wide computer column">
            <div class="ui segment">

                @if (Model.Internship.ActivityStats.InternshipSubmissionsCount > 0)
                {
                    <div class="ui red label left ribbon">@StringHelper.GetPluralWord(Model.Internship.ActivityStats.InternshipSubmissionsCount, "-", "1 zájemce", "{count} zájemci", "již {count} zájemců")</div>
                }

                <div class="w-body-text-center">
                    <div class="ui horizontal list">
                        <div class="item">
                            <div class="content">
                                @Helpers.MessageHelper.RenderIcon("home") <a href="@Url.Action("Index", "Company", new {codeName = Model.Internship.Company.CompanyCodeName})">
                                    @Model.Internship.Company.CompanyName
                                </a>
                            </div>
                        </div>
                        <div class="item">
                            <div class="content">
                                @Helpers.CountryHelper.GetCountryIcon(Model.Internship.CountryCode) @Model.Internship.CountryName
                            </div>
                        </div>
                        <div class="item">
                            <div class="content">
                                @Helpers.MessageHelper.RenderIcon("marker") @Model.Internship.City
                            </div>
                        </div>
                        <div class="item">
                            <div class="content">
                                @if (Model.Internship.IsPaid)
                                {
                                    @Helpers.MessageHelper.RenderIcon("money green")
                                    <span>@(CurrencyHelper.DisplayCurrencyValue(Model.Internship.Amount, Model.Internship.CurrencyName, Model.Internship.CurrencyShowSignOnLeft)) / @Model.Internship.AmountTypeName</span>
                                }
                                else
                                {
                                    @Helpers.MessageHelper.RenderIcon("money red")
                                    <span>Neplaceno</span>
                                }
                            </div>
                        </div>
                        <div class="item">
                            <div class="content">
                                @Helpers.MessageHelper.RenderIcon("calendar") Nástup od @DateHelper.FormatDate(Model.Internship.StartDate)
                            </div>
                        </div>
                        <div class="item">
                            <div class="content">
                                @if (Model.Internship.HasFlexibleHours)
                                {
                                    @Helpers.MessageHelper.RenderIcon("wait")
                                    <span>Flexibilní pracovní doba</span>
                                }
                                else
                                {
                                    @Helpers.MessageHelper.RenderIcon("wait")
                                    <span>@Model.Internship.WorkingHours</span>
                                }
                            </div>
                        </div>
                    </div>
                </div>

                <div class="w-margin-top-30">

                    <div class="w-body-text-center">
                        <div class="ui button teal large w-override-no-button">
                            Délka: @InternshipHelper.GetInternshipDurationDisplayValue(Model.Internship.MinDurationType, Model.Internship.MinDurationInDefaultValue, Model.Internship.MaxDurationType, Model.Internship.MaxDurationInDefaultValue)
                        </div>
                    </div>

                    <div class="w-margin-top-30">
                        @Html.Raw(Model.Internship.Description)
                    </div>

                </div>
            </div>

        </div>
    </div>

    <div class="ui segment w-margin-top-30">
        <div class="ui grid">
            <div class="sixteen wide mobile sixteen wide tablet sixteen wide computer column">
                <h2>
                    Základní informace
                </h2>

                <table class="ui three column very basic table w-body-text-center w-margin-top-30">
                    <thead>
                        <tr class="center aligned">
                            <th>Firma</th>
                            <th>Místo stáže</th>
                            <th>Nástup od</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="center aligned">
                            <td>
                                <a href="@Url.Action("Index", "Company", new { codeName = Model.Internship.Company.CompanyCodeName })">
                                    @Model.Internship.Company.CompanyName
                                </a>    
                            </td>
                            <td>@Helpers.CountryHelper.GetCountryIcon(Model.Internship.CountryCode) @Model.Internship.CountryName, @Model.Internship.City</td>
                            <td>@DateHelper.FormatDate(Model.Internship.StartDate)</td>
                        </tr>
                </table>

                <table class="ui three column very basic table w-body-text-center w-margin-top-30">
                    <thead>
                        <tr class="center aligned">
                            <th>Délka stáže</th>
                            <th>Odměna / mzda</th>
                            <th>Pracovní doba</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="center aligned">
                            <td>@InternshipHelper.GetInternshipDurationDisplayValue(Model.Internship.MinDurationType, Model.Internship.MinDurationInDefaultValue, Model.Internship.MaxDurationType, Model.Internship.MaxDurationInDefaultValue)</td>
                            <td>
                                @if (Model.Internship.IsPaid)
                                {
                                    <span>@(CurrencyHelper.DisplayCurrencyValue(Model.Internship.Amount, Model.Internship.CurrencyName, Model.Internship.CurrencyShowSignOnLeft)) / @Model.Internship.AmountTypeName</span>
                                }
                                else
                                {
                                    <span>Neplaceno</span>
                                }
                            </td>
                            <td>
                                @if (Model.Internship.HasFlexibleHours)
                                {
                                    @Helpers.MessageHelper.RenderIcon("wait")
                                    <span>Flexibilní pracovní doba</span>
                                }
                                else
                                {
                                    @Helpers.MessageHelper.RenderIcon("wait")
                                    <span>@Model.Internship.WorkingHours</span>
                                }
                            </td>
                        </tr>
                </table>

            </div>
        </div>
    </div>

    <div class="ui segment w-margin-top-30">
        <div class="ui grid">
            <div class="sixteen wide mobile sixteen wide tablet sixteen wide computer column">
                <h2>
                    Požadavky
                </h2>

                <table class="ui three column very basic table w-body-text-center">
                    <thead>
                        <tr class="center aligned">
                            <th>Jazyk</th>
                            <th>Pouze pro studenty</th>
                            <th>Home office</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="center aligned">
                            <td>
                                @{
                                    var languageCount = 0;
                                }
                                @foreach (var requiredLanguage in Model.Internship.RequiredLanguages)
                                {
                                    @Helpers.CountryHelper.GetCountryIcon(requiredLanguage.IconClass)
                                    @requiredLanguage.LanguageName
                                    if (languageCount != Model.Internship.RequiredLanguages.Count() - 1)
                                    {
                                        <br />
                                    }
                                    languageCount++;
                                }
                            </td>
                            <td>@Model.Internship.StudentStatusOption.StudentStatusName</td>
                            <td>@Model.Internship.HomeOfficeOption.HomeOfficeName</td>
                        </tr>
                </table>

                <p>
                    @Html.Raw(Model.Internship.Requirements)
                </p>

            </div>
        </div>
    </div>


    @if (galleryImages.Any())
    {
        <div class="ui segment w-margin-top-30">
            @Html.Partial("~/Views/Modules/Gallery/Base.cshtml", new GalleryView()
                   {
                       GalleryID = "_CompanyGallery",
                       Images = galleryImages
                   })
        </div>
    }

    <div class="ui segment">
        <div class="ui grid">

            <div class="sixteen wide mobile six wide tablet four wide computer column">
                <h2>
                    Firmě
                </h2>
                <div class="ui list">
                    <div class="item">
                        <div class="content">
                            @Helpers.MessageHelper.RenderIcon("building")
                            <a href="@Url.Action("Index", "Company", new { codeName = Model.Internship.Company.CompanyCodeName })">
                                @Model.Internship.Company.CompanyName
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="content">
                            @Helpers.MessageHelper.RenderIcon("map") @Model.Internship.Company.City, @Model.Internship.Company.Address
                        </div>
                    </div>
                    <div class="item">
                        <div class="content">
                            @Helpers.CountryHelper.GetCountryIcon(Model.Internship.Company.CountryCode) @Model.Internship.Company.CountryName
                        </div>
                    </div>
                    <div class="item">
                        <div class="content">
                            @Helpers.MessageHelper.RenderIcon("idea") Založeno @Model.Internship.Company.YearFounded
                        </div>
                    </div>
                    <div class="item">
                        <div class="content">
                            @Helpers.MessageHelper.RenderIcon("users") <span>@Model.Internship.Company.CompanySizeName zaměstnanců</span>
                        </div>
                    </div>

                    @if (!string.IsNullOrEmpty(Model.Internship.Company.Web))
                    {
                        <div class="item">
                            <div class="content">
                                @Helpers.MessageHelper.RenderIcon("laptop")
                                <a href="@Model.Internship.Company.Web">
                                    @Model.Internship.Company.Web
                                </a>
                            </div>
                        </div>
                    }
                </div>

                <div class="w-company-social-icons">

                    @if (!string.IsNullOrEmpty(Model.Internship.Company.Facebook))
                    {
                        <a href="@Model.Internship.Company.Facebook">
                            @Helpers.MessageHelper.RenderIcon("facebook large w-color-facebook")
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.Internship.Company.Twitter))
                    {
                        <a href="@Model.Internship.Company.Twitter">
                            @Helpers.MessageHelper.RenderIcon("twitter large w-color-twitter")
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.Internship.Company.LinkedIn))
                    {
                        <a href="@Model.Internship.Company.LinkedIn">
                            @Helpers.MessageHelper.RenderIcon("linkedin large w-color-linkedin")
                        </a>
                    }
                </div>

            </div>

            <div class="sixteen wide mobile ten wide tablet twelve wide computer column">
                @Html.Partial("~/Views/Modules/GoogleMaps/GoogleMap.cshtml",
                    new GoogleMapView()
                    {
                        Zoom = 15,
                        Lat = Model.Internship.Company.Lat,
                        Lng = Model.Internship.Company.Lng,
                        MarkerTitle = Model.Internship.Company.CompanyName
                    })
            </div>
        </div>
    </div>
</div>
